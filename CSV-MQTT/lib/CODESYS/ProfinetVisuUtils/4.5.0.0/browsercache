<?xml version="1.0" encoding="utf-8"?>
<Library Name="ProfinetVisuUtils, 4.5.0.0 (CODESYS)">
  <Node Name="ProfinetDiagnosisResources" TypeGUID="{6f9dac99-8de1-4efc-8465-68ac443b7d08}" EmbeddedTypeGUIDs="{a9ed5b7e-75c5-4651-af16-d2c27e98cb94};{3b83b776-fb25-43b8-99f2-3c507c9143fc}" Comment=" &#xD;&#xA;| Function block for accessing diagnosis strings from a TextList generated by &quot;PROFINET Diagnosis Resources&quot;.&#xD;&#xA;| Note: Do not access this generated TextList directly. Use this helper function block instead.&#xD;&#xA;&#xD;&#xA; .. admonition:: Example: Get buffered Diagnosis-Data&#xD;&#xA;&#xD;&#xA;    .. code-block:: codesys&#xD;&#xA;    &#xD;&#xA;        PROGRAM DiagExample&#xD;&#xA;        VAR&#xD;&#xA;            submodule : ProfinetCommon.SubmoduleInfo;&#xD;&#xA;            submodules : ProfinetCommon.SubmoduleIterator;  &#xD;&#xA;            diagEntries : ARRAY[0..3] OF ProfinetCommon.SubmoduleDiagnosisEntry;&#xD;&#xA;            numDiagEntries : DINT;&#xD;&#xA;            i : DINT;&#xD;&#xA;            ID : UDINT;&#xD;&#xA;            &#xD;&#xA;            diagRes : PVU.ProfinetDiagnosisResources;   &#xD;&#xA;            channelDiag : ProfinetCommon.ChannelDiagnosisData;&#xD;&#xA;            message : WSTRING(255);&#xD;&#xA;            help : WSTRING(255);&#xD;&#xA;            extMessage : WSTRING(255);&#xD;&#xA;            extHelp : WSTRING(255);     &#xD;&#xA;        END_VAR&#xD;&#xA;        &#xD;&#xA;        &#xD;&#xA;        // init. fucntion block with gnerated TextList (command Add Object -&gt; PROFINET Diagnosis Resources)&#xD;&#xA;        IF(NOT diagRes.xInit AND NOT diagRes.xError) THEN&#xD;&#xA;            diagRes.Init('ProfinetDiagnosisTxt');&#xD;&#xA;        END_IF&#xD;&#xA;&#xD;&#xA;        IF(pnDevice.xDiagnosis) THEN        // the device (here named 'pnDevice' in the device tree)&#xD;&#xA;            submodules.InitByID(pnDevice.ID);       // we use the iterator to run throug all submodules of thsi PN Device&#xD;&#xA;            WHILE(submodules.Next(submodule =&gt; submodule)) DO&#xD;&#xA;                IF(submodule.xStateInformation) THEN                    // some valid info in SubmoduleState ? &#xD;&#xA;                    IF(submodule.SubmoduleState.IdentInfo &lt;&gt; ProfinetCommon.SubmoduleState_IdentInfo.OK) THEN&#xD;&#xA;                        ;//--&gt;  'Wrong Module' or sth. like that&#xD;&#xA;                    END_IF&#xD;&#xA;                    &#xD;&#xA;                    IF(submodule.SubmoduleState.xDiagnosis) THEN        // submodule has any diagnosis entries ?&#xD;&#xA;                        numDiagEntries := ProfinetCommon.GetSubmoduleDiagnosis(submodule.ID, diagEntries);&#xD;&#xA;                        i := 0;&#xD;&#xA;                        WHILE i &lt; numDiagEntries DO&#xD;&#xA;                            //clear text&#xD;&#xA;                            message := &quot;&quot;;&#xD;&#xA;                            help  := &quot;&quot;;&#xD;&#xA;                            extMessage  := &quot;&quot;;&#xD;&#xA;                            extHelp  := &quot;&quot;;                 &#xD;&#xA;&#xD;&#xA;                            //resolve numeric error codes tor diagnosis text, e.g. for usage in HMI&#xD;&#xA;                            ID := submodule.ID;&#xD;&#xA;                            channelDiag := diagEntries[i].Diagnosis;&#xD;&#xA;                            IF(diagRes.TryGetDiagMessage(ID, channelDiag, ADR(message), SIZEOF(message))) THEN&#xD;&#xA;                                diagRes.TryGetDiagHelp(ID, channelDiag, ADR(help), SIZEOF(help));       // get additional help&#xD;&#xA;                                &#xD;&#xA;                                IF(channelDiag.ExtChannelErrorType &gt; 0) THEN            // extended error code ? -&gt; more detailed message&#xD;&#xA;                                    IF(diagRes.TryGetExtDiagMessage(ID, channelDiag, ADR(extMessage), SIZEOF(extMessage))) THEN&#xD;&#xA;                                        diagRes.TryGetExtDiagHelp(ID, channelDiag, ADR(extHelp), SIZEOF(extHelp));&#xD;&#xA;                                    END_IF  &#xD;&#xA;                                END_IF&#xD;&#xA;                            END_IF      &#xD;&#xA;                            &#xD;&#xA;                            i := i + 1;         // hint: set breakpoint here to check values&#xD;&#xA;                        END_WHILE               &#xD;&#xA;                    END_IF&#xD;&#xA;                    &#xD;&#xA;                END_IF&#xD;&#xA;            END_WHILE&#xD;&#xA;        END_IF&#xD;&#xA;" ObjectGUID="{23bf17b5-1368-4c35-bf6a-95dc38db9931}">
    <Node Name="TryGetExtDiagMessage" TypeGUID="{f8a58466-d7f6-439f-bbb8-d4600e41d099}" EmbeddedTypeGUIDs="{a9ed5b7e-75c5-4651-af16-d2c27e98cb94};{3b83b776-fb25-43b8-99f2-3c507c9143fc}" Comment=" Get diagnosis message for ExtChannelErrorType." ObjectGUID="{00ee0b32-73ad-42e5-b159-7095b78dca6d}" />
    <Node Name="TryGetExtDiagHelp" TypeGUID="{f8a58466-d7f6-439f-bbb8-d4600e41d099}" EmbeddedTypeGUIDs="{a9ed5b7e-75c5-4651-af16-d2c27e98cb94};{3b83b776-fb25-43b8-99f2-3c507c9143fc}" Comment=" Get  additional help text for ExtChannelErrorType." ObjectGUID="{358c4bb3-5869-4cc9-9e61-e628ac96e116}" />
    <Node Name="TryGetDiagMessage" TypeGUID="{f8a58466-d7f6-439f-bbb8-d4600e41d099}" EmbeddedTypeGUIDs="{a9ed5b7e-75c5-4651-af16-d2c27e98cb94};{3b83b776-fb25-43b8-99f2-3c507c9143fc}" Comment=" Get diagnosis message for ChannelErrorType." ObjectGUID="{54aeb0b6-a4c6-4d4c-ae55-0edb1721d341}" />
    <Node Name="TryGetDiagHelp" TypeGUID="{f8a58466-d7f6-439f-bbb8-d4600e41d099}" EmbeddedTypeGUIDs="{a9ed5b7e-75c5-4651-af16-d2c27e98cb94};{3b83b776-fb25-43b8-99f2-3c507c9143fc}" Comment=" Get additional help text for ChannelErrorType." ObjectGUID="{d89e7a08-d123-445d-932a-c49cf0f14d04}" />
    <Node Name="InitKeyPrefix" TypeGUID="{f8a58466-d7f6-439f-bbb8-d4600e41d099}" EmbeddedTypeGUIDs="{a9ed5b7e-75c5-4651-af16-d2c27e98cb94};{3b83b776-fb25-43b8-99f2-3c507c9143fc}" ObjectGUID="{de915c10-e814-4a1a-9c3d-ba5131e3a375}" />
    <Node Name="Init" TypeGUID="{f8a58466-d7f6-439f-bbb8-d4600e41d099}" EmbeddedTypeGUIDs="{a9ed5b7e-75c5-4651-af16-d2c27e98cb94};{3b83b776-fb25-43b8-99f2-3c507c9143fc}" Comment=" Initialize funtion block with TextList generated by &quot;PROFINET Diagnosis Resources&quot;" ObjectGUID="{e120a3b9-7944-437b-b38a-f9f260e014ea}" />
  </Node>
  <Node Name="Library Manager" TypeGUID="{adb5cb65-8e1d-4a00-b70a-375ea27582f3}" EmbeddedTypeGUIDs="" ObjectGUID="{8c1463b5-02f2-427d-bd06-9e39d42fcbff}" />
</Library>